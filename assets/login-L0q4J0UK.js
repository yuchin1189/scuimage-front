import{T as k,W as T,bJ as $,U as M,J as P,K as q,L as l,h as o,M as c,O as p,a0 as a,b9 as B,aV as g,_ as F,N,a2 as R}from"./index-Dye-7HYz.js";import{c as U,a as b,u as A,d as f}from"./index.esm-SHBVkGDE.js";import{v as C}from"./index-BFZ3CMxV.js";import{b as V}from"./route-block-B_A1xBdJ.js";import{b as h,a as L,V as D}from"./VRow-CfRmg7EG.js";import{V as I}from"./VDivider-Ddfa82oE.js";import{V as J}from"./VForm-G2IQUSL7.js";const j={class:"text-center"},E={class:"text-center"},K={__name:"login",setup(O){const{t:e}=k(),{api:v}=R(),m=T(),w=$(),_=M(),x=U({username:b().required(e("api.usernameRequired")).min(4,e("api.usernameTooShort")).max(30,e("api.usernameTooLong")).test("isAlphanumeric",e("api.usernameInvalid"),s=>C.isAlphanumeric(s)),password:b().required(e("api.userPasswordRequired")).min(4,e("api.userPasswordTooShort")).max(20,e("api.userPasswordTooLong"))}),{handleSubmit:S,isSubmitting:d}=A({validationSchema:x}),u=f("username"),i=f("password"),y=S(async s=>{var r,t;try{const{data:n}=await v.post("/user/login",{username:s.username,password:s.password});_.login(n.result),m({text:e("login.success"),snackbarProps:{color:"success",rounded:"pill"}}),w.push("/")}catch(n){console.log("pages/login.vue 註冊失敗",n),m({text:e("api."+(((t=(r=n==null?void 0:n.response)==null?void 0:r.data)==null?void 0:t.message)||"unknownError")),snackbarProps:{color:"error",rounded:"pill"}})}});return(s,r)=>(P(),q(D,{class:"mt-lg-5",height:"100vh"},{default:l(()=>[o(L,{class:"justify-center"},{default:l(()=>[o(h,{cols:"12"},{default:l(()=>[c("h1",j,p(s.$t("nav.userMenu.login")),1)]),_:1}),o(I),o(h,{cols:"12",sm:"6",md:"6",lg:"4"},{default:l(()=>[o(J,{disabled:a(d),onSubmit:B(a(y),["prevent"])},{default:l(()=>[o(g,{modelValue:a(u).value.value,"onUpdate:modelValue":r[0]||(r[0]=t=>a(u).value.value=t),"error-messages":a(u).errorMessage.value,label:s.$t("user.username"),minlength:"4",maxlength:"30",counter:""},null,8,["modelValue","error-messages","label"]),o(g,{modelValue:a(i).value.value,"onUpdate:modelValue":r[1]||(r[1]=t=>a(i).value.value=t),type:"password","error-messages":a(i).errorMessage.value,label:s.$t("user.password"),minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages","label"]),c("div",E,[o(F,{loading:a(d),type:"submit",color:"primary"},{default:l(()=>[N(p(s.$t("login.submit")),1)]),_:1},8,["loading"])])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};typeof V=="function"&&V(K);export{K as default};
